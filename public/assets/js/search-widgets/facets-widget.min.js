!function () { function e() { var e = "filter", t = "__sf-range__", a = "DateAndTime", n = document.getElementById("facetContainer"), r = document.getElementById("applied-filters"), u = 10; if (n) { n.addEventListener("change", (function (e) { e && e.target && e.target.attributes["data-custom-range"] || (v(e.target), l(b(n, e.target))) })); var i = document.getElementById("sf-facet-clear-all-btn"); i && i.addEventListener("click", (function () { n.querySelectorAll('input[type="checkbox"]:checked').forEach((function (e) { e.checked = !1 })); var e = n.querySelectorAll("input[data-custom-range]"); e && e.forEach((function (e) { e.value = "" })), r.innerText = "", l(b(n, null)) })); var o = document.querySelectorAll('[id^="show-more-less"]'), c = document.querySelectorAll('[id^="custom-range"]'); (o || c) && n.addEventListener("click", (function (e) { if (e.target && e.target.id.startsWith("show-more-less")) { var n = e.target.attributes["data-facet-type"].value, r = e.target.attributes["show-less"].value, i = e.target.attributes["show-more"].value, o = "facets-group-list-" + n; !function (e, t, a, n) { var r = e.some((function (e) { return e.hasAttribute("hidden") })); r ? (e.forEach((function (e) { e.removeAttribute("hidden") })), t.target.innerText = a) : (e.slice(u).forEach((function (e) { e.setAttribute("hidden", "true") })), t.target.innerText = n) }(Array.from(document.querySelectorAll("#" + o + ">li")), e, r, i) } var c = e.target.id.startsWith("custom-range-btn") ? e.target : e.target.closest('[id^="custom-range-btn"]'); c && function (e) { var n = e.attributes["data-custom-range-name"], r = e.attributes["data-custom-range-type"]; if (n && r) { var u = n.value, i = r.value; if (u && i) { var o = document.getElementById("from-" + u), c = document.getElementById("to-" + u); if (o && c) { !function (e) { var t = document.getElementById("facets-group-list-" + e); if (t) { t.querySelectorAll('input[type="checkbox"]:checked').forEach((function (e) { e.checked = !1, v(e) })) } }(u); var m = o.value, g = c.value; if (null != m && "" !== m && null != g && "" !== g) { var h = function (e, n, r) { if (e === a) { var u = new Date(n); u.setHours(0); var i = new Date(r); return i.setHours(0), u.toISOString() + t + i.toISOString() } return n + t + r }(i, m, g), p = s(i, m, g), y = "facet-checkbox-" + u + "-" + h, b = !0, k = document.getElementById(y); k && (b = !1, k.checked = !0), f(u, h, p, b); var A = w(); d(A), l(E(A, u, !1)) } } } } }(c) })) } function l(t) { var a = JSON.stringify(t), n = window.location.search, r = new Querystring(n.substring(1, n.length)); if (t && t.appliedFilters && t.appliedFilters.length > 0) { var u = btoa(a); r.set(e, u), m(!0) } else r.remove(e), m(!1); var i = function (e) { var t = window.location.href.split("?")[0]; e.remove("page"); var a = t + "?" + e.toString(); return a }(r); !function (e) { var t = new XMLHttpRequest; t.open("GET", e, !0), t.setRequestHeader("Content-type", "application/json; charset=utf-8"), t.setRequestHeader("Accept", "application/json"), document.dispatchEvent(new CustomEvent("beginLoadingSearchResults")), t.onreadystatechange = function () { if (4 === t.readyState && 200 === t.status && t.responseText) { var e = (new DOMParser).parseFromString(t.responseText, "text/html"); e && (document.dispatchEvent(new CustomEvent("searchResultsLoaded", { detail: { searchResultsPageDocument: e } })), function (e) { var t = e.getElementById("facetContent"); document.getElementById("facetContent").innerHTML = t.innerHTML, p(), k() }(e)) } }, t.onerror = function () { document.dispatchEvent(new CustomEvent("searchResultsLoaded", { detail: { searchResultsPageDocument: null } })) }, t.send(null) }(i), window.history.pushState({ path: i }, "", i) } function s(e, t, n) { if (e === a) { var r = new Date(t), u = { month: "short", day: "numeric" }, i = r.toLocaleString(void 0, u) + " " + r.getFullYear(), o = new Date(n); return i + " - " + (o.toLocaleString(void 0, u) + " " + o.getFullYear()) } return t + " - " + n } function d(e) { document.querySelectorAll("[data-selected-custom-range]").forEach((function (t) { var a = t.attributes["data-facet-value"], n = t.attributes["data-facet-key"]; if (a && n) { var r = a.value, u = n.value, i = { filterValue: r, isCustom: !0 }; e.hasOwnProperty(u) ? e[u].push(i) : e[u] = [i] } })) } function f(e, t, a, n) { var u, i, o = g(e, t); if (!(null !== document.getElementById(o))) { u = e, (i = r.querySelectorAll('[data-selected-custom-range][data-facet-key="' + u + '"]')) && i.forEach((function (e) { r.removeChild(e.parentElement) })); var c = h(o, e, t, a, n); r.appendChild(c) } } function m(e) { var t = document.getElementById("sf-facet-clear-all-btn"); t && (e ? t.removeAttribute("hidden") : t.setAttribute("hidden", "true")) } function v(e) { if (e && "input" === e.tagName.toLowerCase() && !e.attributes["data-custom-range"]) { var t = e.attributes["data-facet-key"].value, a = e.attributes["data-facet-value"].value, n = e.parentElement.getElementsByTagName("label")[0].textContent, u = g(t, a), i = document.getElementById(u); if (e.checked) { var o = h(u, t, a, n, !1); r.appendChild(o), function (e) { var t = "[data-facet-key='" + e + "']", a = t + "[data-selected-custom-range]", n = document.querySelector(a); n && r.removeChild(n.parentElement) }(t) } else r.removeChild(i.parentElement) } } function g(e, t) { return "remove-facet-filter-" + e + "-" + t } function h(e, t, a, n, u) { var i = r.attributes["data-sf-filter-label-css-class"].value, o = r.attributes["data-sf-applied-filter-html-tag"].value || "span", c = document.createElement(o); c.setAttribute("class", i), c.innerText = n; var l = r.attributes["data-sf-remove-filter-css-class"].value, s = document.createElement("span"); return s.setAttribute("id", e), s.setAttribute("role", "button"), s.setAttribute("tabindex", "0"), s.setAttribute("title", "Remove"), s.setAttribute("class", l), s.setAttribute("data-facet-key", t), s.setAttribute("data-facet-value", a), u && s.setAttribute("data-selected-custom-range", !0), s.innerText = "✕", c.appendChild(s), c } function p(n) { var r = window.location.search, u = new Querystring(r.substring(1, r.length)).get(e); if (u) { m(!0); var i = atob(u); JSON.parse(i).appliedFilters.forEach((function (e) { e.filterValues.forEach((function (r) { var u = decodeURIComponent(e.fieldName), i = decodeURIComponent(r.filterValue), o = "facet-checkbox-" + u + "-" + i, c = document.getElementById(o); if (c || (o = o.replace(/\./g, ","), c = document.getElementById(o)), c) c.checked = !0, n && v(c); else { var l = "facets-group-list-" + u, d = document.getElementById(l); if (d) { var m = d.attributes["data-facet-type"]; if (m) { var g = m.value; g && function (e, n, r) { var u = document.getElementById("from-" + e), i = document.getElementById("to-" + e); if (u && i) { var o = n.split(t); if (o && o.length > 0) { var c = o[0], l = o[1]; if (null != c && null != l) r === a && (c = y(c), l = y(l)), u.value = c, i.value = l, f(e, n, s(r, c, l), !0) } } }(u, i, g) } } } })) })) } } function y(e) { var t = new Date(e), a = t.getMonth() + 1; 2 !== (a = a.toString()).length && (a = "0" + a); var n = t.getDate().toString(); return 2 !== n.length && (n = "0" + n), t.getFullYear() + "-" + a + "-" + n } function b(e, t) { if (e) { var a, n = w(); t && "input" === t.tagName.toLowerCase() && (a = t.attributes["data-facet-key"].value); var r = !1; return t && "input" === t.tagName.toLowerCase() && (a = t.attributes["data-facet-key"].value, r = !t.checked), d(n), E(n, a, r) } } function E(e, t, a) { return { appliedFilters: Object.keys(e).map((function (t) { return { fieldName: t, filterValues: e[t] } })), lastSelectedFilterGropName: t, isDeselected: a } } function k() { if (n) { var e = function (e) { var t = Object.keys(e).map((function (t) { return { fieldName: t, filterValues: e[t] } })); return t }(w()); e.forEach((function (e) { var t = e.fieldName, a = document.getElementById("show-more-less-" + t); if (a) { var n = a.attributes["show-less"].value, r = e.filterValues, i = "facets-group-list-" + t, o = Array.from(document.querySelectorAll("#" + i + ">li")), c = []; o.forEach((function (e) { var t = e.getElementsByTagName("input")[0].attributes["data-facet-value"].value, a = encodeURIComponent(t); c.push(a) })); for (var l = 0; l < r.length; l++) { if (c.indexOf(r[l]) > u - 1) { o.forEach((function (e) { e.removeAttribute("hidden"), a.innerText = n })); break } } } })) } } function w() { var e = {}, t = n.querySelectorAll('input[type="checkbox"]:checked'); return t && t.forEach((function (t) { var a = t.attributes["data-facet-key"].value, n = t.attributes["data-facet-value"].value, r = encodeURIComponent(a), u = { filterValue: encodeURIComponent(n), isCustom: !1 }; e.hasOwnProperty(r) ? e[r].push(u) : e[r] = [u] })), e } r && r.addEventListener("click", (function (e) { if (e.target && e.target.hasAttribute("data-facet-key")) { var t = e.target.parentElement; r.removeChild(t); var a = e.target.attributes["data-facet-key"].value, u = e.target.attributes["data-facet-value"].value; if (e.target.hasAttribute("data-selected-custom-range")) { var i = "facets-group-list-" + a, o = document.querySelectorAll("#" + i + " input"); o && o.forEach((function (e) { e.value = "" })) } else { var c = "facet-checkbox-" + a + "-" + u, l = document.getElementById(c); l && (l.checked = !1) } n.dispatchEvent(new Event("change")) } })), p(!0), k() } document.addEventListener("DOMContentLoaded", (function () { e() })) }();